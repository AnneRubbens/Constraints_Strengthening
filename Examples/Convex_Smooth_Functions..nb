Notebook[{Cell[
BoxData[RowBox[{"(*\[IndentingNewLine]In this notebook, we compute the one-point strengthening \[IndentingNewLine]   pij <= 0\[IndentingNewLine]for the set of constraints \n      fi>=fi+<gi,xj-xi>+",FractionBox[
"\[Alpha]",RowBox[{"2"," ","L"}]],"||gi-gj||^2,\[IndentingNewLine]      ||gi-gj||^2<=L^2||xi-xj||^2\[IndentingNewLine]This strenghtening procedure is explained at length in the work\[IndentingNewLine][1] Rubbens, Anne, Hendrickx, Julien M., and Taylor, Adrien B. \"a constructive approach to strengthen algebraic descriptions of function and operator classes.\"\[IndentingNewLine]*)\n"}]],
"Input",ExpressionUUID -> "0dcff1d4-ae82-46a1-8980-bb562a99f4a6"],Cell[
BoxData[{RowBox[
{RowBox[{"ClearAll","[","\"Global`*\"","]"}],"\[IndentingNewLine]",RowBox[{RowBox[
{RowBox[{"ineq1","[",RowBox[{"xi_",",","xj_",",","fi_",",","fj_",",","gi_",",","gj_"}],"]"}],":="," ",RowBox[
{RowBox[{"-","fi"}],"+","fj","+",RowBox[{"gj","*",RowBox[{"(",RowBox[{"xi","-","xj"}],")"}]}],"+",RowBox[
{RowBox[{RowBox[{"\[Alpha]","/","2"}],"/","L"}],RowBox[{RowBox[{"(",RowBox[{"gi","-","gj"}],")"}],"^","2"}]}],"-","\[Tau]"}]}],";"}]}],"\n",RowBox[
{RowBox[{RowBox[{RowBox[{"ineq2","[",RowBox[{"xi_",",","xj_",",","fi_",",","fj_",",","gi_",",","gj_"}],"]"}],":="," ",RowBox[
{RowBox[{RowBox[{"(",RowBox[{"gj","-","gi"}],")"}],"^","2"}],"-",RowBox[{RowBox[{"L","^","2"}],RowBox[
{RowBox[{"(",RowBox[{"xi","-","xj"}],")"}],"^","2"}]}],"-",RowBox[{"2","*","L","*","\[Tau]"}]}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Lagrangian","=",RowBox[{"\[Tau]","+",RowBox[{"\[Lambda]1"," ",RowBox[{"ineq1","[",RowBox[
{"z",",","x1",",","fz",",","f1",",","gz",",","g1"}],"]"}]}],"+",RowBox[{"\[Lambda]2"," ",RowBox[
{"ineq1","[",RowBox[{"z",",","x2",",","fz",",","f2",",","gz",",","g2"}],"]"}]}],"+",RowBox[
{"\[Mu]1"," ",RowBox[{"ineq1","[",RowBox[{"x1",",","z",",","f1",",","fz",",","g1",",","gz"}],"]"}]}],"+",RowBox[
{"\[Mu]2"," ",RowBox[{"ineq1","[",RowBox[{"x2",",","z",",","f2",",","fz",",","g2",",","gz"}],"]"}]}],"+",RowBox[
{"\[Delta]1"," ",RowBox[{"ineq2","[",RowBox[{"z",",","x1",",","fz",",","f1",",","gz",",","g1"}],"]"}]}],"+",RowBox[
{"\[Delta]2"," ",RowBox[{"ineq2","[",RowBox[{"z",",","x2",",","fz",",","f2",",","gz",",","g2"}],"]"}]}]}]}],";"}]}]}],
"Input",CellChangeTimes -> {{3926065814.3914948`,3926066224.378626`},3926066717.8721857`,3926068741.025529`,{3947649677.482329`,3947649739.344821`},{3947649841.1782002`,3947649878.036911`},{3947660483.7430277`,3947660485.3326683`}},
ExpressionUUID -> "3404f507-7d88-4a65-8f19-370f696cac61"],Cell[
"\< \>","Text",CellFrame -> {{0,0},{0,0.5`}},
CellFrameMargins -> 0,Selectable -> False,ShowCellBracket -> False,CellFrameColor -> RGBColor[
0,0,1],Editable -> False,CellSize -> {Inherited,3},ExpressionUUID -> "03be9546-913d-4644-b200-60154703912c",
CellMargins -> {{0,0},{1,1}},CellElementSpacings -> {"CellMinHeight" -> 1}],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{"Solving"," ","the"," ","inner"," ","problem"}],","," ",RowBox[
{"[",RowBox[{"1",","," ",RowBox[{"Eq",".",RowBox[{"(","1",")"}]}]}],"]"}]}]," ","*)"}],"\n",RowBox[
{RowBox[{"\[Delta]2sol","=",RowBox[{"Solve","[",RowBox[{RowBox[{RowBox[{"D","[",RowBox[
{"Lagrangian",",","\[Tau]"}],"]"}],"==","0"}],",","\[Delta]2"}],"]"}]}]," ",RowBox[
{"(*"," ",RowBox[{"Linear"," ","in"," ","\[Tau]"}]," ","*)"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Lagrangian2","=",RowBox[{"Lagrangian","//.",RowBox[{"\[Delta]2sol","[",RowBox[
{"[","1","]"}],"]"}]}]}],";"}],"\[IndentingNewLine]",RowBox[{"\[Lambda]1sol","=",RowBox[
{"Solve","[",RowBox[{RowBox[{RowBox[{"D","[",RowBox[{"Lagrangian2",",","fz"}],"]"}],"==","0"}],",","\[Lambda]1"}],"]"}]}]," ",RowBox[
{"(*"," ",RowBox[{"Linear"," ","in"," ","fz"}]," ","*)"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Lagrangian3","=",RowBox[{RowBox[{"Lagrangian2","//.",RowBox[{"\[Lambda]1sol","[",RowBox[
{"[","1","]"}],"]"}]}],"//","Simplify"}]}],";"}],"\[IndentingNewLine]",RowBox[{RowBox[
{"gzsol","=",RowBox[{"Solve","[",RowBox[{RowBox[{RowBox[{"D","[",RowBox[{"Lagrangian3",",","gz"}],"]"}],"==","0"}],",","gz"}],"]"}]}]," ",";"}],RowBox[
{"(*"," ",RowBox[{"Convex"," ","in"," ","gz"}]," ","*)"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Lagrangian4","=",RowBox[{RowBox[{"Lagrangian3","//.",RowBox[{"gzsol","[",RowBox[
{"[","1","]"}],"]"}]}],"//","Simplify"}]}],";"}],"\n",RowBox[{"(*",RowBox[{RowBox[
{"Maximization"," ","in"," ","z"}],","," ",RowBox[{"[",RowBox[{"1",","," ",RowBox[
{"Eq",".",RowBox[{"(","1",")"}]}]}],"]"}]}],"*)"}],"\n",RowBox[{RowBox[{"zsol","=",RowBox[
{RowBox[{"Solve","[",RowBox[{RowBox[{RowBox[{"D","[",RowBox[{"Lagrangian4",",","z"}],"]"}],"==","0"}],",","z"}],"]"}],"//","Simplify"}]}],";"}],"\n",RowBox[
{RowBox[{"zconcavity","=",RowBox[{RowBox[{"D","[",RowBox[{RowBox[{"D","[",RowBox[
{"Lagrangian4",",","z"}],"]"}],",","z"}],"]"}],"//","Simplify"}]}],";"}]," ",RowBox[
{"(*"," ",RowBox[{"Verify"," ","concavity"," ","in"," ","z"}]," ","*)"}],"\n",RowBox[
{RowBox[{"Lagrangian5","=",RowBox[{RowBox[{"Lagrangian4","//.",RowBox[{"zsol","[",RowBox[
{"[","1","]"}],"]"}]}],"//","Simplify"}]}],";"}]}]}]],"Input",CellChangeTimes -> {{3926066227.2104053`,3926066239.446762`},{3926066719.9259768`,3926066731.669743`},{3947649884.856224`,3947649919.845598`},{3947650055.016568`,3947650073.2918673`}},
ExpressionUUID -> "28864992-8d6b-4c75-8be0-05842d7bdea1"],Cell[
BoxData[RowBox[{"{",RowBox[
{"{",RowBox[{"\[Delta]2","\[Rule]",FractionBox[RowBox[{"1","-",RowBox[{"2"," ","L"," ","\[Delta]1"}],"-","\[Lambda]1","-","\[Lambda]2","-","\[Mu]1","-","\[Mu]2"}],
RowBox[{"2"," ","L"}]]}],"}"}],"}"}]],"Output",CellLabel -> "Out[16]= ",ExpressionUUID -> "08ea382d-9388-4ad2-96fd-1df3a0e85aad"],Cell[
BoxData[
RowBox[{"{",RowBox[{"{",RowBox[{"\[Lambda]1","\[Rule]",RowBox[{RowBox[{"-","\[Lambda]2"}],"+","\[Mu]1","+","\[Mu]2"}]}],"}"}],"}"}]],
"Output",CellLabel -> "Out[18]= ",ExpressionUUID -> "e7890ad3-cd01-4b95-929d-18a0ebff2d9c"]},
Open],ExpressionUUID -> "fb7a8c5c-45b5-49b9-9436-f4d72d2ea29b"],Cell[
"\< \>","Text",
CellFrame -> {{0,0},{0,0.5`}},CellFrameMargins -> 0,Selectable -> False,ShowCellBracket -> False,
CellFrameColor -> RGBColor[0,0,1],Editable -> False,CellSize -> {Inherited,3},ExpressionUUID -> "396cd56c-239a-45d0-971f-819b92cbb661",
CellMargins -> {{0,0},{1,1}},CellElementSpacings -> {"CellMinHeight" -> 1}],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{RowBox[{"(*"," ",RowBox[{"Sanity"," ",RowBox[{"check",":"," ",RowBox[
{RowBox[{"do"," ","we"," ","recover"," ","the"," ","inequality"}]," ","||",RowBox[
{"g1","-","g2"}],"||",RowBox[{"<=","L"}],"||",RowBox[{"x1","-","x2"}],"||"," ",RowBox[
{"for"," ","certain"," ",RowBox[{"choices","?"}]}]}]}]}]," ","*)"}],"\n","\n",RowBox[
{RowBox[{RowBox[{"subs","=",RowBox[{"{",RowBox[{RowBox[{"\[Lambda]2","\[Rule]","0"}],",",RowBox[
{"\[Mu]1","\[Rule]","0"}],",",RowBox[{"\[Mu]2","\[Rule]","0"}],",",RowBox[{"\[Delta]1","\[Rule]",RowBox[
{RowBox[{"1","/","4"}],"/","L"}]}]}],"}"}]}],";"}],"\[IndentingNewLine]",RowBox[{"Lagrangian6","=",RowBox[
{RowBox[{"Lagrangian5","//.","subs"}],"//","Simplify"}]}]}]}]],"Input",CellChangeTimes -> {{3926066739.7093673`,3926066752.654685`},{3947649928.964985`,3947649963.7991`},3947650053.4621067`},
ExpressionUUID -> "633db714-8e4a-4161-895f-b638253be8e0"],Cell[
BoxData[FractionBox[
RowBox[{SuperscriptBox["g1","2"],"-",RowBox[{"2"," ","g1"," ","g2"}],"+",SuperscriptBox[
"g2","2"],"-",RowBox[{SuperscriptBox["L","2"]," ",SuperscriptBox[RowBox[{"(",RowBox[
{"x1","-","x2"}],")"}],"2"]}]}],RowBox[{"8"," ","L"}]]],"Output",CellLabel -> "Out[26]= ",
ExpressionUUID -> "4572a635-87b2-4c51-af6d-56f318c14b7a"]},Open],ExpressionUUID -> "ff6e833e-1854-4232-a0ee-01d945f1ad37"],Cell[

"\< \>","Text",CellFrame -> {{0,0},{0,0.5`}},CellFrameMargins -> 0,Selectable -> False,
ShowCellBracket -> False,CellFrameColor -> RGBColor[0,0,1],Editable -> False,CellSize -> {Inherited,3},
ExpressionUUID -> "7127acd1-14ca-4c30-bd64-c7bc8d4486be",CellMargins -> {{0,0},{1,1}},
CellElementSpacings -> {"CellMinHeight" -> 1}],Cell[
BoxData[RowBox[{"(*"," ",RowBox[
{RowBox[{RowBox[{"How"," ","to"," ","reach"," ","the"," ","desired"," ","inequality"," "," ","f2"}],">=",RowBox[
{"f1","+"}],"<","g1"}],",",RowBox[{RowBox[{RowBox[{"x2","-","x1"}],">",RowBox[{RowBox[
{RowBox[{"+",RowBox[{"(",RowBox[{"1","+","\[Alpha]"}],")"}]}],"/","4"}],"/","L"}]}]," ","||",RowBox[
{"g1","-","g2"}],"||",RowBox[{"^",RowBox[{RowBox[{"2"," ","[",RowBox[{"1",","," ",RowBox[
{"Proposition"," ","2"}]}],"]"}],"?"}]}]}]}]," ","*)"}]],"Input",CellChangeTimes -> {{3926068157.184155`,3926068160.494754`},{3947649974.1544247`,3947650034.066884`},3947650382.680657`},
ExpressionUUID -> "b25d472c-4fe8-4b89-af5d-72aebfbf67a0"],Cell[
CellGroupData[{Cell[
BoxData[
{RowBox[{RowBox[{RowBox[{"subs","=",RowBox[{"{",RowBox[{RowBox[{"\[Lambda]2","\[Rule]","0"}],",",RowBox[
{"\[Mu]1","\[Rule]","0"}],",",RowBox[{"\[Delta]1","\[Rule]","0"}]}],"}"}]}],";"}]," "}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Lagrangian7","=",RowBox[{RowBox[{"Lagrangian5","//.","subs"}],"//","Simplify"}]}],";"}],"\n",RowBox[
{RowBox[{"CoeffF1","=",RowBox[{RowBox[{"Coefficient","[",RowBox[{"Lagrangian7",",","f1"}],"]"}],"//","Simplify"}]}],";"}],"\n",RowBox[
{RowBox[{"ResToMaximize","=",RowBox[{RowBox[{"(",RowBox[{RowBox[{"Lagrangian7","/","CoeffF1"}],"-",RowBox[
{"(",RowBox[{RowBox[{"-","f2"}],"+","f1","+",RowBox[{"g1",RowBox[{"(",RowBox[{"x2","-","x1"}],")"}]}]}],")"}]}],")"}],"//","Simplify"}]}]," ",RowBox[
{"(*"," ",RowBox[{"ResToMaximize"," ","englobes"," ","all"," ","possible"," ","additional"," ","terms"," ","to"," ","the"," ","initial"," ","constraint"}]," ","*)"}],"\n"}],"\n",RowBox[
{RowBox[{"\[Mu]2sol","=",RowBox[{RowBox[{"Solve","[",RowBox[{RowBox[{"{",RowBox[{RowBox[
{"D","[",RowBox[{RowBox[{RowBox[{"Coefficient","[",RowBox[{"ResToMaximize",",",RowBox[
{"g1","^","2"}]}],"]"}],"==","0"}],",","\[Mu]2"}],"]"}],",",RowBox[{"0","<","\[Mu]2","<",RowBox[
{"1","/","2"}]}]}],"}"}],",","\[Mu]2"}],"]"}],"//","FullSimplify"}]}]," ",RowBox[
{"(*"," ",RowBox[{RowBox[{"Domain"," ","of"," ","\[Mu]2"," ","follows"," ","from"," ","\[Delta]2"}],">","0"}]," ","*)"}]}],"\n",RowBox[
{"ResToMaximize1","=",RowBox[{RowBox[{"ResToMaximize","//.","\[Mu]2sol"}],"//","FullSimplify"," ",RowBox[
{"(*"," ",RowBox[{"ResToMaximize1"," ","=",RowBox[{"||",RowBox[{"g1","-","g2"}],"||",RowBox[
{RowBox[{"^","2"}]," ",RowBox[{RowBox[{RowBox[{"(",RowBox[{"1","+","\[Alpha]"}],")"}],"/","4"}],"/","L"}]}]}]}]," ","*)"}]}]}]}],
"Input",CellChangeTimes -> {{3926066783.609931`,3926066863.8819838`},{3926068373.7498317`,3926068374.746974`},{3926068934.1967397`,3926068974.2251863`},3926069018.478662`,{3947650040.244583`,3947650048.702384`}},
ExpressionUUID -> "6aadc0b8-937d-4e1e-9261-59ac0d4d614e"],Cell[
BoxData[FractionBox[
RowBox[{SuperscriptBox[RowBox[{"(",RowBox[{"g1","-","g2"}],")"}],"2"]," ",RowBox[
{"(",RowBox[{RowBox[{"\[Mu]2"," ",RowBox[{"(",RowBox[{RowBox[{"-","1"}],"+",RowBox[
{"2"," ","\[Mu]2"}]}],")"}]}],"+",RowBox[{SuperscriptBox["\[Alpha]","2"]," ","\[Mu]2"," ",RowBox[
{"(",RowBox[{RowBox[{"-","1"}],"+",RowBox[{"2"," ","\[Mu]2"}]}],")"}]}],"+",RowBox[
{"\[Alpha]"," ",RowBox[{"(",RowBox[{RowBox[{"-","1"}],"+",RowBox[{"4"," ","\[Mu]2"}],"-",RowBox[
{"5"," ",SuperscriptBox["\[Mu]2","2"]}]}],")"}]}]}],")"}]}],RowBox[{"2"," ","L"," ",RowBox[
{"(",RowBox[{RowBox[{"-","1"}],"-",RowBox[{"2"," ",RowBox[{"(",RowBox[{RowBox[{"-","2"}],"+","\[Alpha]"}],")"}]," ","\[Mu]2"}],"+",RowBox[
{RowBox[{"(",RowBox[{RowBox[{"-","5"}],"+",RowBox[{"4"," ","\[Alpha]"}]}],")"}]," ",SuperscriptBox[
"\[Mu]2","2"]}]}],")"}]}]]],"Output",CellLabel -> "Out[42]= ",ExpressionUUID -> "6922d71d-a5de-41f5-9379-8d128bc850cd"],Cell[
BoxData[
RowBox[{"{",RowBox[{"{",RowBox[{"\[Mu]2","\[Rule]",FractionBox["1","3"]}],"}"}],"}"}]],
"Output",CellLabel -> "Out[43]= ",ExpressionUUID -> "0905ec9e-8e24-4f6b-9686-bdf09fcc190e"],Cell[
BoxData[
RowBox[{"{",FractionBox[RowBox[{SuperscriptBox[RowBox[{"(",RowBox[{"g1","-","g2"}],")"}],
"2"]," ",RowBox[{"(",RowBox[{"1","+","\[Alpha]"}],")"}]}],RowBox[{"4"," ","L"}]],"}"}]],
"Output",CellLabel -> "Out[44]= ",ExpressionUUID -> "c52c7b8c-5566-47b6-90f1-b4673e1e3b6f"]},
Open],ExpressionUUID -> "e18da4c5-20cc-455c-ac0d-231ee7c5878d"]},StyleDefinitions -> "Default.nb",
WindowSize -> {843,1592.25`},WindowMargins -> {{Automatic,-674.25`},{810,Automatic}},
FrontEndVersion -> "14.2 for Wolfram Cloud 1.70.1 (December 30, 2024)",ExpressionUUID -> "a64094e1-9677-4f00-bc51-4eab80cd0e46"]